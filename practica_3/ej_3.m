%%%%%E)%%%%%
%muestras tomadas por el sensor
X= tiempo_v;
Y= distancia_v;
figure
plot(X, Y)
hold on

%distancia real
T=TimeSeconds(1:end-150);
R=100*(SonarMeters(151:end) - ParedMeters(151:end));
plot(T,R)

%eliminar la primera muestra del sensor
X=X(:,2:end);
Y=Y(:,2:end);

%calculo de puntos extremos
[m1, b1] = PunExtremos(X, Y);
y_ext = m1 * X + b1;
plot(X, y_ext)

%calculo de mínimos cuadrados
[m2, b2] = MinCuadrados(X.', Y.');
y_min = m2 * X + b2;
plot(X, y_min)

%%%%%F)%%%%%

%linealidad%
figure
plot(X,y_ext' - R(1:length(y_ext)))
hold on
plot(X,y_min' - R(1:length(y_min)))


%repetibilidad%
%muestras de PE
%a = y_ext en diferentes muestras
a1= [162.399990000000	161.419170000000	160.438350000000	159.457530000000	158.476700000000	157.495880000000	156.515060000000	155.534240000000	154.553420000000	153.572600000000	152.591780000000	151.610950000000	150.630130000000	149.649310000000	148.668490000000	147.687670000000	146.706850000000	145.726010000000	144.745190000000	143.764370000000	142.783550000000	141.802730000000	140.821910000000	139.841090000000	138.860260000000	137.879440000000	136.898620000000	135.917800000000	134.936980000000	133.956160000000	132.975340000000	131.994510000000	131.013690000000	130.032870000000	129.052050000000	128.071230000000	127.090410000000	126.109590000000	125.128760000000	124.147940000000	123.167110000000	122.186290000000	121.205470000000	120.224660000000	119.243840000000	118.263010000000	117.282190000000	116.301360000000	115.320540000000	114.339720000000	113.358900000000	112.378080000000	111.397250000000	110.416440000000	109.435610000000	108.454790000000	107.473970000000	106.493150000000	105.512330000000	104.531500000000	103.550680000000	102.569850000000	101.589040000000	100.608220000000	99.6273960000000	98.6465760000000	97.6657490000000	96.6849290000000	95.7041020000000	94.7232820000000	93.7424620000000	92.7616420000000	91.7808150000000	90.7999950000000	89.8191760000000	88.8383480000000	87.8575290000000	86.8767090000000	85.8958890000000	84.9150620000000	83.9342420000000	82.9534230000000	81.9725950000000	80.9917760000000	80.0109560000000	79.0301360000000	78.0493090000000	77.0684890000000	76.0876690000000	75.1068420000000	74.1260220000000	73.1452030000000	72.1643830000000	71.1835560000000	70.2027360000000	69.2219160000000	68.2410890000000	67.2602690000000	66.2794490000000	65.2986300000000	64.3178020000000	63.3369830000000	62.3561630000000	61.3753360000000	60.3945160000000	59.4136960000000	58.4328770000000	57.4520490000000	56.4712300000000	55.4904100000000	54.5095830000000	53.5287630000000	52.5479430000000	51.5671230000000	50.5862960000000	49.6054760000000	48.6246570000000	47.6438290000000	46.6630100000000	45.6821900000000	44.7013700000000	43.7205430000000	42.7397230000000	41.7589040000000	40.7780760000000	39.7972560000000	38.8164370000000	37.8356090000000	36.8547900000000	35.8739700000000	34.8931500000000	33.9123230000000	32.9315030000000	31.9506840000000	30.9698640000000	29.9890440000000	29.0082090000000	28.0273900000000	27.0465700000000	26.0657500000000	];
a2= [162.399990000000	161.379270000000	160.358570000000	159.337840000000	158.317140000000	157.296420000000	156.275710000000	155.254990000000	154.234280000000	153.213560000000	152.192860000000	151.172130000000	150.151430000000	149.130710000000	148.110000000000	147.089280000000	146.068570000000	145.047850000000	144.027130000000	143.006420000000	141.985700000000	140.965000000000	139.944270000000	138.923570000000	137.902850000000	136.882140000000	135.861420000000	134.840710000000	133.819990000000	132.799290000000	131.778560000000	130.757840000000	129.737140000000	128.716430000000	127.695710000000	126.675000000000	125.654280000000	124.633560000000	123.612850000000	122.592130000000	121.571430000000	120.550700000000	119.530000000000	118.509280000000	117.488560000000	116.467850000000	115.447140000000	114.426420000000	113.405710000000	112.384990000000	111.364280000000	110.343570000000	109.322850000000	108.302140000000	107.281420000000	106.260710000000	105.239990000000	104.219280000000	103.198560000000	102.177860000000	101.157140000000	100.136420000000	99.1157070000000	98.0949940000000	97.0742800000000	96.0535660000000	95.0328520000000	94.0121380000000	92.9914250000000	91.9707110000000	90.9499970000000	89.9292830000000	88.9085690000000	87.8878480000000	86.8671340000000	85.8464200000000	84.8257060000000	83.8049930000000	82.7842790000000	81.7635650000000	80.7428510000000	79.7221370000000	78.7014240000000	77.6807100000000	76.6599960000000	75.6392820000000	74.6185680000000	73.5978550000000	72.5771410000000	71.5564190000000	70.5357060000000	69.5149920000000	68.4942780000000	67.4735640000000	66.4528500000000	65.4321370000000	64.4114230000000	63.3907090000000	62.3699950000000	61.3492810000000	60.3285680000000	59.3078540000000	58.2871400000000	57.2664260000000	56.2457120000000	55.2249910000000	54.2042770000000	53.1835630000000	52.1628490000000	51.1421360000000	50.1214220000000	49.1007080000000	48.0799940000000	47.0592800000000	46.0385670000000	45.0178530000000	43.9971390000000	42.9764250000000	41.9557110000000	40.9349980000000	39.9142840000000	38.8935620000000	37.8728490000000	36.8521350000000	35.8314210000000	34.8107070000000	33.7899930000000	32.7692870000000	31.7485660000000	30.7278440000000	29.7071380000000	28.6864170000000	27.6657100000000	26.6449890000000	25.6242830000000	24.6035610000000	23.5828550000000	22.5621340000000	21.5414280000000	20.5207060000000	]; 
a3= [162.500000000000	161.488650000000	160.477310000000	159.465960000000	158.454610000000	157.443270000000	156.431920000000	155.420560000000	154.409230000000	153.397870000000	152.386520000000	151.375180000000	150.363830000000	149.352480000000	148.341140000000	147.329790000000	146.318440000000	145.307100000000	144.295750000000	143.284390000000	142.273040000000	141.261700000000	140.250350000000	139.239010000000	138.227660000000	137.216310000000	136.204960000000	135.193620000000	134.182270000000	133.170910000000	132.159580000000	131.148220000000	130.136870000000	129.125530000000	128.114180000000	127.102830000000	126.091490000000	125.080140000000	124.068790000000	123.057450000000	122.046100000000	121.034740000000	120.023410000000	119.012050000000	118.000700000000	116.989360000000	115.978010000000	114.966660000000	113.955310000000	112.943970000000	111.932620000000	110.921270000000	109.909930000000	108.898570000000	107.887230000000	106.875890000000	105.864530000000	104.853190000000	103.841840000000	102.830490000000	101.819150000000	100.807800000000	99.7964480000000	98.7851030000000	97.7737580000000	96.7624050000000	95.7510600000000	94.7397160000000	93.7283630000000	92.7170180000000	91.7056730000000	90.6943210000000	89.6829760000000	88.6716230000000	87.6602780000000	86.6489330000000	85.6375810000000	84.6262360000000	83.6148910000000	82.6035390000000	81.5921940000000	80.5808490000000	79.5694960000000	78.5581510000000	77.5468060000000	76.5354540000000	75.5241090000000	74.5127640000000	73.5014110000000	72.4900670000000	71.4787220000000	70.4673690000000	69.4560240000000	68.4446720000000	67.4333270000000	66.4219820000000	65.4106290000000	64.3992840000000	63.3879390000000	62.3765870000000	61.3652420000000	60.3538970000000	59.3425450000000	58.3312000000000	57.3198550000000	56.3085020000000	55.2971570000000	54.2858120000000	53.2744600000000	52.2631150000000	51.2517700000000	50.2404170000000	49.2290730000000	48.2177200000000	47.2063750000000	46.1950300000000	45.1836780000000	44.1723330000000	43.1609880000000	42.1496350000000	41.1382900000000	40.1269450000000	39.1155930000000	38.1042480000000	37.0929030000000	36.0815510000000	35.0702060000000	34.0588530000000	33.0475160000000	32.0361630000000	31.0248110000000	30.0134740000000	29.0021210000000	27.9907680000000	26.9794310000000	25.9680790000000	24.9567260000000	23.9453890000000	22.9340360000000	21.9226840000000	];

figure
plot(X,a1' - R(1:length(a1)))
hold on
plot(X,a2' - R(1:length(a2)))
plot(X,a3' - R(1:length(a3)))

%muestras de MC
%b = y_min en diferentes muestras
b1= [162.739400000000	161.781300000000	160.823200000000	159.865080000000	158.906980000000	157.948880000000	156.990780000000	156.032680000000	155.074580000000	154.116490000000	153.158370000000	152.200270000000	151.242170000000	150.284070000000	149.325970000000	148.367860000000	147.409760000000	146.451660000000	145.493560000000	144.535460000000	143.577360000000	142.619260000000	141.661150000000	140.703050000000	139.744950000000	138.786850000000	137.828750000000	136.870640000000	135.912540000000	134.954440000000	133.996340000000	133.038240000000	132.080140000000	131.122020000000	130.163930000000	129.205830000000	128.247730000000	127.289630000000	126.331520000000	125.373420000000	124.415310000000	123.457210000000	122.499110000000	121.541020000000	120.582910000000	119.624810000000	118.666700000000	117.708600000000	116.750500000000	115.792400000000	114.834300000000	113.876200000000	112.918090000000	111.959990000000	111.001890000000	110.043790000000	109.085690000000	108.127590000000	107.169480000000	106.211380000000	105.253280000000	104.295180000000	103.337070000000	102.378970000000	101.420870000000	100.462770000000	99.5046690000000	98.5465620000000	97.5884630000000	96.6303630000000	95.6722560000000	94.7141570000000	93.7560580000000	92.7979510000000	91.8398510000000	90.8817520000000	89.9236450000000	88.9655460000000	88.0074460000000	87.0493390000000	86.0912400000000	85.1331410000000	84.1750340000000	83.2169340000000	82.2588350000000	81.3007280000000	80.3426280000000	79.3845290000000	78.4264220000000	77.4683230000000	76.5102230000000	75.5521160000000	74.5940170000000	73.6359180000000	72.6778110000000	71.7197110000000	70.7616120000000	69.8035050000000	68.8454060000000	67.8873060000000	66.9291990000000	65.9711000000000	65.0130000000000	64.0548930000000	63.0967940000000	62.1386950000000	61.1805880000000	60.2224880000000	59.2643890000000	58.3062820000000	57.3481830000000	56.3900830000000	55.4319760000000	54.4738770000000	53.5157780000000	52.5576710000000	51.5995710000000	50.6414720000000	49.6833650000000	48.7252660000000	47.7671660000000	46.8090590000000	45.8509600000000	44.8928530000000	43.9347530000000	42.9766540000000	42.0185470000000	41.0604480000000	40.1023480000000	39.1442410000000	38.1861420000000	37.2280430000000	36.2699360000000	35.3118360000000	34.3537290000000	33.3956300000000	32.4375310000000	31.4794310000000	30.5213320000000	29.5632320000000	];
b2= [163.031250000000	162.020630000000	161.010010000000	159.999390000000	158.988770000000	157.978160000000	156.967540000000	155.956920000000	154.946300000000	153.935680000000	152.925060000000	151.914440000000	150.903820000000	149.893220000000	148.882600000000	147.871980000000	146.861360000000	145.850740000000	144.840120000000	143.829500000000	142.818880000000	141.808260000000	140.797650000000	139.787030000000	138.776410000000	137.765790000000	136.755170000000	135.744550000000	134.733930000000	133.723330000000	132.712710000000	131.702090000000	130.691470000000	129.680850000000	128.670230000000	127.659610000000	126.648990000000	125.638370000000	124.627750000000	123.617140000000	122.606520000000	121.595900000000	120.585280000000	119.574660000000	118.564040000000	117.553420000000	116.542810000000	115.532190000000	114.521580000000	113.510960000000	112.500340000000	111.489720000000	110.479100000000	109.468480000000	108.457860000000	107.447240000000	106.436630000000	105.426010000000	104.415390000000	103.404770000000	102.394150000000	101.383530000000	100.372910000000	99.3622970000000	98.3516770000000	97.3410570000000	96.3304440000000	95.3198240000000	94.3092040000000	93.2985840000000	92.2879710000000	91.2773510000000	90.2667310000000	89.2561110000000	88.2454990000000	87.2348790000000	86.2242580000000	85.2136380000000	84.2030260000000	83.1924060000000	82.1817860000000	81.1711650000000	80.1605450000000	79.1499330000000	78.1393130000000	77.1286930000000	76.1180730000000	75.1074600000000	74.0968400000000	73.0862200000000	72.0756000000000	71.0649870000000	70.0543670000000	69.0437470000000	68.0331270000000	67.0225140000000	66.0118940000000	65.0012740000000	63.9906540000000	62.9800420000000	61.9694210000000	60.9588010000000	59.9481810000000	58.9375610000000	57.9269490000000	56.9163280000000	55.9057080000000	54.8950880000000	53.8844760000000	52.8738560000000	51.8632350000000	50.8526150000000	49.8420030000000	48.8313830000000	47.8207630000000	46.8101430000000	45.7995300000000	44.7889100000000	43.7782900000000	42.7676700000000	41.7570570000000	40.7464370000000	39.7358170000000	38.7251970000000	37.7145770000000	36.7039640000000	35.6933440000000	34.6827240000000	33.6721040000000	32.6614840000000	31.6508640000000	30.6402590000000	29.6296390000000	28.6190190000000	27.6083980000000	26.5977780000000	25.5871580000000	24.5765380000000	23.5659180000000	22.5553130000000    ];
b3= [161.414120000000	160.407440000000	159.400760000000	158.394070000000	157.387390000000	156.380710000000	155.374020000000	154.367340000000	153.360660000000	152.353970000000	151.347290000000	150.340610000000	149.333920000000	148.327240000000	147.320560000000	146.313870000000	145.307190000000	144.300510000000	143.293820000000	142.287160000000	141.280470000000	140.273790000000	139.267110000000	138.260420000000	137.253740000000	136.247060000000	135.240370000000	134.233690000000	133.227010000000	132.220320000000	131.213640000000	130.206950000000	129.200270000000	128.193590000000	127.186900000000	126.180220000000	125.173540000000	124.166850000000	123.160170000000	122.153490000000	121.146800000000	120.140120000000	119.133440000000	118.126750000000	117.120070000000	116.113400000000	115.106710000000	114.100030000000	113.093350000000	112.086660000000	111.079980000000	110.073300000000	109.066620000000	108.059940000000	107.053250000000	106.046570000000	105.039890000000	104.033200000000	103.026520000000	102.019840000000	101.013150000000	100.006470000000	98.9997860000000	97.9931030000000	96.9864200000000	95.9797360000000	94.9730530000000	93.9663700000000	92.9596860000000	91.9530030000000	90.9463200000000	89.9396360000000	88.9329610000000	87.9262770000000	86.9195940000000	85.9129100000000	84.9062270000000	83.8995440000000	82.8928600000000	81.8861770000000	80.8794940000000	79.8728100000000	78.8661270000000	77.8594440000000	76.8527600000000	75.8460770000000	74.8393940000000	73.8327100000000	72.8260350000000	71.8193510000000	70.8126680000000	69.8059840000000	68.7993010000000	67.7926180000000	66.7859340000000	65.7792510000000	64.7725680000000	63.7658840000000	62.7592010000000	61.7525180000000	60.7458340000000	59.7391510000000	58.7324680000000	57.7257840000000	56.7191090000000	55.7124250000000	54.7057420000000	53.6990590000000	52.6923750000000	51.6856920000000	50.6790080000000	49.6723250000000	48.6656420000000	47.6589580000000	46.6522750000000	45.6455920000000	44.6389080000000	43.6322250000000	42.6255420000000	41.6188580000000	40.6121830000000	39.6054990000000	38.5988160000000	37.5921330000000	36.5854490000000	35.5787660000000	34.5720830000000	33.5653990000000	32.5587160000000	31.5520320000000	30.5453490000000	29.5386660000000	28.5319820000000	27.5252990000000	26.5186160000000	25.5119320000000	24.5052490000000	23.4985660000000	22.4918820000000	21.4851990000000	];

figure
plot(X,b1' - R(1:length(b1)))
hold on
plot(X,b2' - R(1:length(b2)))
plot(X,b3' - R(1:length(b3)))


%histéresis
%comparación por PE
c1= a1;    
c2= y_ext; %inversa

figure
plot(X,c1' - R(1:length(c1)))
hold on
plot(X,c2' - R(1:length(c2)))

%Comparación por MC
d1=b1;
d2=y_min; %inversa

figure
plot(X,d1' - R(1:length(d1)))
hold on
plot(X,d2' - R(1:length(d2)))





